# Create an XDP chain
chain myxdpprog BF_HOOK_XDP{ifindex=2} ACCEPT
    rule
        meta.iface eq lo
        meta.iface eq 1
        counter
        ACCEPT
    rule
        meta.l3_proto eq ipv4
        meta.l3_proto eq ipv6
        meta.l3_proto eq IPv4
        meta.l3_proto eq IPv6
        meta.l3_proto eq 1024
        meta.l3_proto eq 0x0600
        counter
        ACCEPT
    rule
        meta.l4_proto eq icmp
        meta.l4_proto eq ICMPv6
        meta.l4_proto eq 6
        counter
        ACCEPT
    rule
        meta.sport eq 0
        meta.sport eq 17
        meta.sport eq 65535
        meta.sport not 0
        meta.sport not 17
        meta.sport not 65535
        meta.sport range 0-65535
        meta.sport range 17-31
        meta.dport eq 0
        meta.dport eq 17
        meta.dport eq 65535
        meta.dport not 0
        meta.dport not 17
        meta.dport not 65535
        meta.dport range 0-65535
        meta.dport range 17-31
        counter
        ACCEPT
    rule
        meta.probability eq 0%
        meta.probability eq 50%
        meta.probability eq 100%
        counter
        ACCEPT
    rule
        ip4.proto eq icmp
        ip4.proto eq ICMPv6
        ip4.proto eq 6
        counter
        ACCEPT
    rule
        ip6.nexthdr eq tcp
        ip6.nexthdr eq udp
        ip6.nexthdr eq icmpv6
        counter
        CONTINUE
    rule
        tcp.sport eq 0
        tcp.sport eq 17
        tcp.sport eq 65535
        tcp.sport not 0
        tcp.sport not 17
        tcp.sport not 65535
        tcp.sport range 0-65535
        tcp.sport range 17-31
        tcp.dport eq 0
        tcp.dport eq 17
        tcp.dport eq 65535
        tcp.dport not 0
        tcp.dport not 17
        tcp.dport not 65535
        tcp.dport range 0-65535
        tcp.dport range 17-31
        counter
        ACCEPT
    rule
        udp.sport eq 0
        udp.sport eq 17
        udp.sport eq 65535
        udp.sport not 0
        udp.sport not 17
        udp.sport not 65535
        udp.sport range 0-65535
        udp.sport range 17-31
        udp.dport eq 0
        udp.dport eq 17
        udp.dport eq 65535
        udp.dport not 0
        udp.dport not 17
        udp.dport not 65535
        udp.dport range 0-65535
        udp.dport range 17-31
        counter
        ACCEPT
    rule
        ip4.saddr in {192.168.1.131,192.168.1.132}
        counter
        ACCEPT
    rule
        ip6.saddr fc00::fbaf:7b6b:ba41:abce
        counter
        ACCEPT
    rule
        ip6.saddr fc00::fbaf:7b6b:ba41:abce/17
        counter
        ACCEPT
    rule
        ip4.saddr 192.168.1.1
        counter
        ACCEPT
    rule
        ip4.daddr 192.168.1.1
        counter
        ACCEPT
    rule
        ip4.proto icmp
        counter
        ACCEPT
    rule
        tcp.flags any SYN,ACK
        counter
        ACCEPT
    rule
        icmp.type eq 8
        icmp.code eq 0
        counter
        ACCEPT
    rule
        icmpv6.type eq 128
        icmpv6.code eq 0
        counter
        ACCEPT
    rule
        ip6.snet in {fdb2:2c26:f4e4::1/128}
        counter
        CONTINUE
    rule
        ip6.snet in {fdb2:2c26:f4e4::1/64}
        counter
        CONTINUE
    rule
        ip6.dnet in {fdb2:2c26:f4e4:0:21c:42ff:fe09:1a95/128}
        counter
        CONTINUE
    rule
        ip6.dnet in {fdb2:2c26:f4e4:0:21c:42ff:fe09:1a95/64}
        counter
        CONTINUE
